<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: Haml::Filters::Base
  
    &mdash; Haml Documentation
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../';
  framesUrl = "../../frames.html#!Haml/Filters/Base.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (B)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Haml.html" title="Haml (module)">Haml</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Filters.html" title="Haml::Filters (module)">Filters</a></span></span>
     &raquo; 
    <span class="title">Base</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Module: Haml::Filters::Base
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
    <dt class="r1">Included in:</dt>
    <dd class="r1"><span class='object_link'><a href="Cdata.html" title="Haml::Filters::Cdata (module)">Cdata</a></span>, <span class='object_link'><a href="Css.html" title="Haml::Filters::Css (module)">Css</a></span>, <span class='object_link'><a href="Escaped.html" title="Haml::Filters::Escaped (module)">Escaped</a></span>, <span class='object_link'><a href="Javascript.html" title="Haml::Filters::Javascript (module)">Javascript</a></span>, <span class='object_link'><a href="Plain.html" title="Haml::Filters::Plain (module)">Plain</a></span>, <span class='object_link'><a href="Preserve.html" title="Haml::Filters::Preserve (module)">Preserve</a></span>, <span class='object_link'><a href="Ruby.html" title="Haml::Filters::Ruby (module)">Ruby</a></span></dd>
    
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/haml/filters.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>The base module for Haml filters. User-defined filters should be modules including this module. The name of the filter is taken by downcasing the module name. For instance, if the module is named <code>FooBar</code>, the filter will be <code>:foobar</code>.</p>

<p>A user-defined filter should override either <span class='object_link'><a href="#render-instance_method" title="Haml::Filters::Base#render (method)">#render</a></span> or <span class='object_link'><a href="#compile-instance_method" title="Haml::Filters::Base#compile (method)">#compile</a></span>. <span class='object_link'><a href="#render-instance_method" title="Haml::Filters::Base#render (method)">#render</a></span> is the most common. It takes a string, the filter source, and returns another string, the result of the filter. For example, the following will define a filter named <code>:sass</code>:</p>

<pre class="code ruby"><code class="ruby">module Haml::Filters::Sass
  include Haml::Filters::Base

  def render(text)
    ::Sass::Engine.new(text).render
  end
end</code></pre>

<p>For details on overriding <span class='object_link'><a href="#compile-instance_method" title="Haml::Filters::Base#compile (method)">#compile</a></span>, see its documentation.</p>

<p>Note that filters overriding <span class='object_link'><a href="#render-instance_method" title="Haml::Filters::Base#render (method)">#render</a></span> automatically support <code>#{}</code> for interpolating Ruby code. Those overriding <span class='object_link'><a href="#compile-instance_method" title="Haml::Filters::Base#compile (method)">#compile</a></span> will need to add such support manually if it’s desired.</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#included-class_method" title="included (class method)">+ <strong>included</strong>(base) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This method is automatically called when <span class='object_link'><a href="" title="Haml::Filters::Base (module)">Base</a></span> is included in a module.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#compile-instance_method" title="#compile (instance method)">- <strong>compile</strong>(compiler, text) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This should be overridden when a filter needs to have access to the Haml evaluation context.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#internal_compile-instance_method" title="#internal_compile (instance method)">- <strong>internal_compile</strong>(*args) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Same as <span class='object_link'><a href="#compile-instance_method" title="Haml::Filters::Base#compile (method)">#compile</a></span>, but requires the necessary files first.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#render-instance_method" title="#render (instance method)">- (String) <strong>render</strong>(text) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Takes the source text that should be passed to the filter and returns the result of running the filter on that string.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#render_with_options-instance_method" title="#render_with_options (instance method)">- (String) <strong>render_with_options</strong>(text, options) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Same as <span class='object_link'><a href="#render-instance_method" title="Haml::Filters::Base#render (method)">#render</a></span>, but takes a <span class='object_link'><a href="../Engine.html" title="Haml::Engine (class)">Engine</a></span> options hash as well.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="included-class_method">
  
    + <strong>included</strong>(base) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This method is automatically called when <span class='object_link'><a href="" title="Haml::Filters::Base (module)">Haml::Filters::Base</a></span> is included in a module. It automatically defines a filter with the downcased name of that module. For example, if the module is named <code>FooBar</code>, the filter will be <code>:foobar</code>.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>base</span>
      
      
        <span class='type'>(<tt>Module</tt>, <tt>Class</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The module that this is included in</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


106
107
108
109</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/filters.rb', line 106</span>

def self.included(base)
  Filters.defined[base.name.split(&quot;::&quot;).last.downcase] = base
  base.extend(base)
end</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="compile-instance_method">
  
    - <strong>compile</strong>(compiler, text) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This should be overridden when a filter needs to have access to the Haml evaluation context. Rather than applying a filter to a string at compile-time, <span class='object_link'><a href="#compile-instance_method" title="Haml::Filters::Base#compile (method)">#compile</a></span> uses the <span class='object_link'><a href="../Compiler.html" title="Haml::Compiler (class)">Compiler</a></span> instance to compile the string to Ruby code that will be executed in the context of the active Haml template.</p>

<p>Warning: the <span class='object_link'><a href="../Compiler.html" title="Haml::Compiler (class)">Compiler</a></span> interface is neither well-documented nor guaranteed to be stable. If you want to make use of it, you’ll probably need to look at the source code and should test your filter when upgrading to new Haml versions.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>compiler</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Compiler.html" title="Haml::Compiler (class)">Haml::Compiler</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The compiler instance</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>text</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The text of the filter</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Error.html" title="Haml::Error (class)">Haml::Error</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if none of <span class='object_link'><a href="#compile-instance_method" title="Haml::Filters::Base#compile (method)">#compile</a></span>, <span class='object_link'><a href="#render-instance_method" title="Haml::Filters::Base#render (method)">#render</a></span>, and <span class='object_link'><a href="#render_with_options-instance_method" title="Haml::Filters::Base#render_with_options (method)">#render_with_options</a></span> are overridden</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/filters.rb', line 160</span>

def compile(compiler, text)
  filter = self
  compiler.instance_eval do
    if contains_interpolation?(text)
      return if options[:suppress_eval]

      text = unescape_interpolation(text).gsub(/(\\+)n/) do |s|
        escapes = $1.size
        next s if escapes % 2 == 0
        (&quot;\\&quot; * (escapes - 1)) + &quot;\n&quot;
      end
      # We need to add a newline at the beginning to get the
      # filter lines to line up (since the Haml filter contains
      # a line that doesn&#39;t show up in the source, namely the
      # filter name). Then we need to escape the trailing
      # newline so that the whole filter block doesn&#39;t take up
      # too many.
      text = &quot;\n&quot; + text.sub(/\n&quot;\Z/, &quot;\\n\&quot;&quot;)
      push_script &lt;&lt;RUBY.rstrip, :escape_html =&gt; false
find_and_preserve(#{filter.inspect}.render_with_options(#{text}, _hamlout.options))
RUBY
      return
    end

    rendered = Haml::Helpers::find_and_preserve(filter.render_with_options(text, compiler.options), compiler.options[:preserve])

    if options[:ugly]
      push_text(rendered.rstrip)
    else
      push_text(rendered.rstrip.gsub(&quot;\n&quot;, &quot;\n#{&#39;  &#39; * @output_tabs}&quot;))
    end
  end
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="internal_compile-instance_method">
  
    - <strong>internal_compile</strong>(*args) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Same as <span class='object_link'><a href="#compile-instance_method" title="Haml::Filters::Base#compile (method)">#compile</a></span>, but requires the necessary files first. <em>This is used by <span class='object_link'><a href="../Engine.html" title="Haml::Engine (class)">Engine</a></span> and is not intended to be overridden or used elsewhere.</em></p>


  </div>
</div>
<div class="tags">
  

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#compile-instance_method" title="Haml::Filters::Base#compile (method)">#compile</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


140
141
142</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/filters.rb', line 140</span>

def internal_compile(*args)
  compile(*args)
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="render-instance_method">
  
    - (<tt>String</tt>) <strong>render</strong>(text) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Takes the source text that should be passed to the filter and returns the result of running the filter on that string.</p>

<p>This should be overridden in most individual filter modules to render text with the given filter. If <span class='object_link'><a href="#compile-instance_method" title="Haml::Filters::Base#compile (method)">#compile</a></span> is overridden, however, <span class='object_link'><a href="#render-instance_method" title="Haml::Filters::Base#render (method)">#render</a></span> doesn’t need to be.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>text</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The source text for the filter to process</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The filtered result</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Error.html" title="Haml::Error (class)">Haml::Error</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if it’s not overridden</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


121
122
123</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/filters.rb', line 121</span>

def render(text)
  raise Error.new(&quot;#{self.inspect}#render not defined!&quot;)
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="render_with_options-instance_method">
  
    - (<tt>String</tt>) <strong>render_with_options</strong>(text, options) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Same as <span class='object_link'><a href="#render-instance_method" title="Haml::Filters::Base#render (method)">#render</a></span>, but takes a <span class='object_link'><a href="../Engine.html" title="Haml::Engine (class)">Engine</a></span> options hash as well. It’s only safe to rely on options made available in <span class='object_link'><a href="../Engine.html#options_for_buffer-instance_method" title="Haml::Engine#options_for_buffer (method)">Engine#options_for_buffer</a></span>.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>text</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The source text for the filter to process</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The filtered result</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Error.html" title="Haml::Error (class)">Haml::Error</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if it or <span class='object_link'><a href="#render-instance_method" title="Haml::Filters::Base#render (method)">#render</a></span> isn’t overridden</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#render-instance_method" title="Haml::Filters::Base#render (method)">#render</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


132
133
134</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/filters.rb', line 132</span>

def render_with_options(text, options)
  render(text)
end</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Sun Jan 25 08:27:35 2015 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.2.0).
</div>


  <script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script>
  <script type="text/javascript">
  try {
  var pageTracker = _gat._getTracker("UA-3592613-6");
  pageTracker._trackPageview();
  } catch(err) {}</script>


  </body>
</html>