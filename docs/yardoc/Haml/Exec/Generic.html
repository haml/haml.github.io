<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Haml::Exec::Generic
  
    &mdash; Haml Documentation
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Haml::Exec::Generic";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (G)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Haml.html" title="Haml (module)">Haml</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Exec.html" title="Haml::Exec (module)">Exec</a></span></span>
     &raquo; 
    <span class="title">Generic</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Haml::Exec::Generic
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'>Object</span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'>Object</span></li>
          
            <li class="next">Haml::Exec::Generic</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/haml/exec.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>An abstract class that encapsulates the executable code for all three executables.</p>


  </div>
</div>
<div class="tags">
  

</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="Haml.html" title="Haml::Exec::Haml (class)">Haml</a></span></p>
</div>







  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#color-instance_method" title="#color (instance method)">#<strong>color</strong>(color, str)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Wraps the given string in terminal escapes causing it to have the given color.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#get_line-instance_method" title="#get_line (instance method)">#<strong>get_line</strong>(exception)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Finds the line of the source template on which an exception was raised.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(args)  &#x21d2; Generic </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A new instance of Generic.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse-instance_method" title="#parse (instance method)">#<strong>parse</strong>  </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Parses the command-line arguments and runs the executable.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse!-instance_method" title="#parse! (instance method)">#<strong>parse!</strong>  </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Parses the command-line arguments and runs the executable.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#process_result-instance_method" title="#process_result (instance method)">#<strong>process_result</strong>  </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Processes the options set by the command-line arguments.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#puts-instance_method" title="#puts (instance method)">#<strong>puts</strong>(*args)  </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Same as <code>Kernel.puts</code>, but doesn’t print anything if the <code>--quiet</code> option is set.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#puts_action-instance_method" title="#puts_action (instance method)">#<strong>puts_action</strong>(name, color, arg)  </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Prints a status message about performing the given action, colored using the given color (via terminal escapes) if possible.</p>
</div></span>
  
</li>

      
        <li class="protected ">
  <span class="summary_signature">
    
      <a href="#set_opts-instance_method" title="#set_opts (instance method)">#<strong>set_opts</strong>(opts)  </a>
    

    
  </span>
  
  
  
  <span class="note title protected">protected</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Tells optparse how to parse the arguments available for all executables.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_s-instance_method" title="#to_s (instance method)">#<strong>to_s</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A description of the executable.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(args)  &#x21d2; <tt><span class='object_link'><a href="" title="Haml::Exec::Generic (class)">Generic</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns a new instance of Generic.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>args</span>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The command-line arguments</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


13
14
15
16</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/exec.rb', line 13</span>

def initialize(args)
  @args = args
  @options = {:for_engine =&gt; {}}
end</pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="color-instance_method">
  
    #<strong>color</strong>(color, str)  &#x21d2; <tt>String</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Wraps the given string in terminal escapes
causing it to have the given color.
If terminal esapes aren’t supported on this platform,
just returns the string instead.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>color</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The name of the color to use.
Can be <code>:red</code>, <code>:green</code>, or <code>:yellow</code>.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>str</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The string to wrap in the given color.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The wrapped string.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


155
156
157
158
159
160
161
162
163</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/exec.rb', line 155</span>

def color(color, str)
  raise &quot;[BUG] Unrecognized color #{color}&quot; unless COLORS[color]

  # Almost any real Unix terminal will support color,
  # so we just filter for Windows terms (which don&#39;t set TERM)
  # and not-real terminals, which aren&#39;t ttys.
  return str if ENV[&quot;TERM&quot;].nil? || ENV[&quot;TERM&quot;].empty? || !STDOUT.tty?
  return &quot;\e[#{COLORS[color]}m#{str}\e[0m&quot;
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_line-instance_method">
  
    #<strong>get_line</strong>(exception)  &#x21d2; <tt>String</tt>  <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Finds the line of the source template
on which an exception was raised.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>exception</span>
      
      
        <span class='type'>(<tt>Exception</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The exception</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The line number</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


61
62
63
64
65
66
67</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/exec.rb', line 61</span>

def get_line(exception)
  # SyntaxErrors have weird line reporting
  # when there&#39;s trailing whitespace,
  # which there is for Haml documents.
  return (exception.message.scan(/:(\d+)/).first || [&quot;??&quot;]).first if exception.is_a?(::SyntaxError)
  (exception.backtrace[0].scan(/:(\d+)/).first || [&quot;??&quot;]).first
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parse-instance_method">
  
    #<strong>parse</strong>  
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Parses the command-line arguments and runs the executable.
This does not handle exceptions or exit the program.</p>


  </div>
</div>
<div class="tags">
  

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#parse!-instance_method" title="Haml::Exec::Generic#parse! (method)">#parse!</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


40
41
42
43
44
45
46
47</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/exec.rb', line 40</span>

def parse
  @opts = OptionParser.new(&amp;method(:set_opts))
  @opts.parse!(@args)

  process_result

  @options
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parse!-instance_method">
  
    #<strong>parse!</strong>  
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Parses the command-line arguments and runs the executable.
Calls <code>Kernel#exit</code> at the end, so it never returns.</p>


  </div>
</div>
<div class="tags">
  

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="#parse-instance_method" title="Haml::Exec::Generic#parse (method)">#parse</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


22
23
24
25
26
27
28
29
30
31
32
33
34</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/exec.rb', line 22</span>

def parse!
  begin
    parse
  rescue Exception =&gt; e
    raise e if @options[:trace] || e.is_a?(SystemExit)

    $stderr.print &quot;#{e.class}: &quot; unless e.class == RuntimeError
    $stderr.puts &quot;#{e.message}&quot;
    $stderr.puts &quot;  Use --trace for backtrace.&quot;
    exit 1
  end
  exit 0
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="process_result-instance_method">
  
    #<strong>process_result</strong>   <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Processes the options set by the command-line arguments.
In particular, sets <code>@options[:input]</code> and <code>@options[:output]</code>
to appropriate IO streams.</p>

<p>This is meant to be overridden by subclasses
so they can run their respective programs.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


110
111
112
113
114
115
116
117
118
119
120
121
122</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/exec.rb', line 110</span>

def process_result
  input, output = @options[:input], @options[:output]
  args = @args.dup
  input ||=
    begin
      filename = args.shift
      @options[:filename] = filename
      open_file(filename) || $stdin
    end
  output ||= open_file(args.shift, &#39;w&#39;) || $stdout

  @options[:input], @options[:output] = input, output
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="puts-instance_method">
  
    #<strong>puts</strong>(*args)   <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Same as <code>Kernel.puts</code>, but doesn’t print anything if the <code>--quiet</code> option is set.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>args</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Passed on to <code>Kernel.puts</code></p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


141
142
143
144</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/exec.rb', line 141</span>

def puts(*args)
  return if @options[:for_engine][:quiet]
  Kernel.puts(*args)
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="puts_action-instance_method">
  
    #<strong>puts_action</strong>(name, color, arg)   <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Prints a status message about performing the given action,
colored using the given color (via terminal escapes) if possible.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt>#<span class='object_link'><a href="#to_s-instance_method" title="Haml::Exec::Generic#to_s (method)">to_s</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A short name for the action being performed.
Shouldn’t be longer than 11 characters.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>color</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The name of the color to use for this action.
Can be <code>:red</code>, <code>:green</code>, or <code>:yellow</code>.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


133
134
135
136</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/exec.rb', line 133</span>

def puts_action(name, color, arg)
  return if @options[:for_engine][:quiet]
  printf color(color, &quot;%11s %s\n&quot;), name, arg
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_opts-instance_method">
  
    #<strong>set_opts</strong>(opts)   <span class="extras">(protected)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Tells optparse how to parse the arguments
available for all executables.</p>

<p>This is meant to be overridden by subclasses
so they can add their own options.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>OptionParser</tt>)</span>
      
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/exec.rb', line 76</span>

def set_opts(opts)
  opts.on(&#39;-s&#39;, &#39;--stdin&#39;, :NONE, &#39;Read input from standard input instead of an input file&#39;) do
    @options[:input] = $stdin
  end

  opts.on(&#39;--trace&#39;, :NONE, &#39;Show a full traceback on error&#39;) do
    @options[:trace] = true
  end

  opts.on(&#39;--unix-newlines&#39;, &#39;Use Unix-style newlines in written files.&#39;) do
    # Note that this is the preferred way to check for Windows, since
    # JRuby and Rubinius also run there.
    if RbConfig::CONFIG[&#39;host_os&#39;] =~ /mswin|windows|mingw/i
      @options[:unix_newlines] = true
    end
  end

  opts.on_tail(&quot;-?&quot;, &quot;-h&quot;, &quot;--help&quot;, &quot;Show this message&quot;) do
    puts opts
    exit
  end

  opts.on_tail(&quot;-v&quot;, &quot;--version&quot;, &quot;Print version&quot;) do
    puts(&quot;Haml #{::Haml::VERSION}&quot;)
    exit
  end
end</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_s-instance_method">
  
    #<strong>to_s</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns A description of the executable.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A description of the executable</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


50
51
52</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/haml/exec.rb', line 50</span>

def to_s
  @opts.to_s
end</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue Jun  2 09:24:09 2020 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.25 (ruby-2.8.0).
</div>


  <script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script>
  <script type="text/javascript">
  try {
  var pageTracker = _gat._getTracker("UA-3592613-6");
  pageTracker._trackPageview();
  } catch(err) {}</script>


    </div>
  </body>
</html>